## Configuration (`fwsimple.cfg`)

`fwsimple` uses a central configuration file, typically located at `/etc/fwsimple/fwsimple.cfg` (though you can specify a different path when running `fwsimple` if your version supports it - currently, the main entry point hardcodes this path). This file uses an INI-style format.

It contains three main sections: `[fwsimple]`, `[policy]`, and `[zones]`.

### `[fwsimple]` Section

This section defines core operational parameters for `fwsimple`.

-   **`rulesets`**:
    -   Description: Specifies the directory path where your `.rule` files are stored. `fwsimple` will read all files ending with `.rule` from this location.
    -   Example: `rulesets = /etc/fwsimple/rules`

-   **`engine`**:
    -   Description: Determines which firewall backend `fwsimple` will use to implement the rules.
    -   Supported values:
        -   `iptables`: For generating rules compatible with the traditional iptables firewall.
        -   `nftables`: For generating rules compatible with the modern nftables framework.
    -   Example: `engine = nftables`

### `[policy]` Section

This section defines the default policies for traffic entering or leaving the system through different base chains/directions. These policies are applied if no specific rule matches the traffic.

-   **`in`**:
    -   Description: Default policy for incoming traffic (e.g., to the `INPUT` chain in iptables/nftables).
    -   Accepted values: `accept`, `reject`, `discard`.
    -   Example: `in = reject`

-   **`out`**:
    -   Description: Default policy for outgoing traffic generated by the system itself (e.g., to the `OUTPUT` chain).
    -   Accepted values: `accept`, `reject`, `discard`.
    -   Example: `out = accept`

-   **`forward`**:
    -   Description: Default policy for traffic being forwarded through the system (e.g., to the `FORWARD` chain).
    -   Accepted values: `accept`, `reject`, `discard`.
    -   Example: `forward = reject`

    *Note on policy actions:*
    *   `accept`: Allows the traffic.
    *   `reject`: Blocks the traffic and sends a rejection notification (e.g., ICMP port unreachable or TCP reset).
    *   `discard`: Silently drops the traffic with no notification. (This is often referred to as `DROP` in iptables/nftables contexts; `fwsimple` uses `discard` as its keyword which maps to `DROP` in iptables and `drop` in nftables).

### `[zones]` Section

This section is used to define network zones, which are essentially named groups of network interfaces and/or source IP addresses/networks. Rules are then applied to these zones.

-   **Syntax**:
    -   Simple interface assignment: `zonename = interface_name`
        -   Example: `public = eth0`
    -   Multiple interfaces for one zone: `zonename = interface1,interface2,interface3`
        -   Example: `internal_ports = eth1,eth2`
    -   Interface with source IP/network restriction: `zonename = interface_name:source_ip/mask`
        -   This means traffic arriving on `interface_name` specifically from `source_ip/mask` will belong to this zone for rule processing.
        -   Example: `dmz_lan = eth0:192.168.100.0/24`
    -   Multiple interface/source definitions for one zone: `zonename = if1:src1/mask1,if2:src2/mask2,...`
        -   Example: `vpn_access = tun0:10.8.0.0/24,tun1:10.9.0.0/24`
    -   A single zone can also combine simple interfaces and interface:source pairs:
        -   Example: `trusted_access = eth1,eth0:172.16.0.0/24`

-   **Order of Evaluation**: When multiple zone definitions could potentially match incoming traffic (e.g., a generic `public = eth0` and a more specific `dmz_lan = eth0:192.168.100.0/24`), `fwsimple` prioritizes more specific definitions (those with source IP/network restriction) over general interface-only definitions for the same interface.
